# TIL - 2026年01月20日

## 今日のメモ
ER図のブラッシュアップ完了！ER図の卒制LGTMいただきました！
次のissue作成は手こずりそうだな…

# 📝 開発日誌 - 2026/01/20（月）

## 🎯 本日の目標
ER図を完成させ、面接時に説明できる状態に仕上げる
## 📸 スクリーンショット
[![Image from Gyazo](https://i.gyazo.com/4c5f504126398089ef86c1e913250a56.png)](https://gyazo.com/4c5f504126398089ef86c1e913250a56)

---

## ✅ 実施内容

### 1. 📊 DBスキーマ技術ドキュメントの作成・最終仕上げ

#### 概要
就職活動の技術面接で活用するための、データベーススキーマの包括的なドキュメントを完成させました。単なるテーブル定義の羅列ではなく、設計意図や技術的判断の根拠を明確にした資料に仕上げています。

#### 作業詳細

**🔄 Usersテーブル正規化リファクタリング計画の策定**
- 現行の `users` テーブルを正規化し、以下の4テーブルへの分割を計画
  - users（認証コア情報）
  - google_accounts（OAuth連携情報）
  - user_settings（アプリ設定）
  - user_profiles（プロフィール情報）
- `is_admin` カラムの削除方針を決定

**📋 自動生成テーブルの注意書き追加**
- Active Storage（画像管理）関連テーブル
- Solid Cache（キャッシュ）関連テーブル
- これらが gem による自動生成であることを明記

**🔢 Integer Enum採用の技術的根拠を明文化**
- `priority`, `daypart`, `stamp` などのEnumカラムについて
- 文字列enumではなく整数enumを採用した理由（パフォーマンス、DBサイズ、インデックス効率）を記載

**❓ 面接想定Q&A用の補足説明を追加**
- `daypart` カラム: 歩行記録の時刻から朝/昼/夕/夜を自動分類するロジックの説明
- `user_achievements` テーブル: ユーザーと実績の多対多関係を管理する中間テーブルの設計意図
- `goal_meters` カラム: ユーザーごとにカスタマイズ可能なデフォルト目標値の設計
- `walked_on` と `created_at` の使い分け: 業務上の日付とシステム記録日時の分離

**📎 その他の改善**
- `web_push_subscriptions.endpoint` に text型を使用した理由（URL長の可変性対応）
- カラム命名規則の一貫性についての説明

---

### 2. 🌿 ER図修正ブランチの作成

**ブランチ名:** 29-fix-er-diagram

ER図の修正作業用にフィーチャーブランチを新規作成し、リモートにプッシュしました。

---

## 📈 成果物

| 種別 | 内容 |
|------|------|
| ドキュメント | DBスキーマ技術資料（Usersテーブル正規化計画含む） |
| ブランチ | 29-fix-er-diagram |

---

## 💡 技術的なポイント・学び

- **正規化と非正規化のトレードオフ**: 過度な正規化はJOINコストを増加させるため、アクセスパターンを考慮したテーブル設計が重要
- **Enumの設計**: Rails標準の integer enum は DB層でのパフォーマンスが優れており、マイグレーション時の柔軟性も確保できる
- **ドキュメント駆動開発**: 実装前に設計意図を文書化することで、後のコードレビューや技術面接での説明がスムーズになる

---


## 気分・状態
今日の気分: 😁 (5: とても気分が良い)
今日のモチベーション: 🌈 (5: とてもやる気がある)
目標の進捗: 🌳 (5: とてもよく進んだ)

---
*Generated by ちいくさ日記*  
*Date: 2026-01-20*  
*Created: 2026-01-20 22:26:20*
