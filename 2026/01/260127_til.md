# TIL - 2026年01月27日

## 今日のメモ
勉強時間：9時間

さすがにRails応用は難しい…初ギブアップ使っちゃいました :sob: 
NOAさんのプチアウトプット会に参加、かなり良い内容だった
やっぱ73期って学習意欲高い人多いなと感心してしまった

応用STEP　進捗率47％


# 👨‍💻 2026-01-26 (Mon) 開発日誌 Report

## 🚀 Today's Highlights
**「記事表現力の向上」と「コア機能の拡張」**
本日は、記事詳細ページにおける表現の自由度を高める2つの新機能（アイキャッチ画像の配置・サイズ指定、Twitter埋め込み）をリリースしました。
また、トップページ刷新に向けた画像アップローダーの複数枚対応（スライダー化）に着手し、既存のバリデーションロジックのリファクタリングを行いました。

## 📸 Screenshots
[![Image from Gyazo](https://t.gyazo.com/teams/startup-technology/db729deeaf467bd1db31dc2397fa933c.gif)](https://startup-technology.gyazo.com/db729deeaf467bd1db31dc2397fa933c)

<br>

## 📝 Works

### 1. 🎨 アイキャッチ画像のサイズ・配置指定機能の実装 (PR #7 Merged)
記事の表現力を高めるため、アイキャッチ画像の表示スタイルを投稿者が制御できる機能を追加しました。

- **機能概要**:
  - 画像の表示幅（%指定）と配置（左寄せ・中央・右寄せ）を選択可能に。
  - プレビュー画面でのリアルタイム反映。
- **技術的工夫**:
  - `Article` モデルにスタイル情報を保存するカラムを追加し、CSSクラスを動的に生成するPresenter層（Decorator）で表示ロジックを分離。
  - システムテストを追加し、各パターンの表示崩れがないことを保証。

### 2. 🐦 埋め込みメディアへのTwitter(X)対応 (PR #8 Merged)
YouTubeに加え、技術記事で需要の高いTwitter(X)の埋め込みに対応しました。

- **実装詳細**:
  - `Embed` モデルのEnumに `twitter` を追加。
  - 正規表現によるURLバリデーションを追加し、不正なURLの入力を防止。
  - 管理画面でのプレビュー表示と、フロントエンドでの埋め込みコード展開を実装。

### 3. 🔧 画像アップローダーの改修 & リファクタリング (WIP)
ブログトップ画像をスライダー形式（複数枚表示）にするための基盤作りを開始しました。

- **課題**: 既存の `AttachmentValidator` が単一ファイル (`has_one_attached`) のみに依存した設計になっており、複数ファイル (`has_many_attached`) に適用するとエラーが発生する状態だった。
- **対応**:
  - バリデーターを拡張し、渡された値が `ActiveStorage::Attached::One` なのか `Many` なのかを判別して処理を分岐させるロジックへリファクタリング。
  - `Site` モデルの設定を変更し、トップ画像を複数枚保存できるようにスキーマを変更中。

<br>

## 💡 Tech Note & Learnings
- **バリデーションの汎用化**:
  単一アタッチメント前提で書かれたカスタムバリデーターを、複数アタッチメントにも対応させる際、Railsの `attachables` の扱い（Arrayとして渡されるかどうか）の違いを吸収する必要がありました。将来的な他箇所での再利用も見据え、汎用的な記述に変更しました。

- **UI/UXへの意識**:
  アイキャッチ画像のサイズ調整機能において、単に数値を入力させるだけでなく、管理画面上でどう見えるかを即座に確認できるようプレビュー機能を重視しました。

---
[app/models/article.rb]
`app/validators/attachment_validator.rb`
`app/views/admin/articles/_form.html.slim`

## 気分・状態
今日の気分: 😁 (5: とても気分が良い)
今日のモチベーション: 🌈 (5: とてもやる気がある)
目標の進捗: 🌳 (5: とてもよく進んだ)

---
*Generated by ちいくさ日記*  
*Date: 2026-01-27*  
*Created: 2026-01-27 08:10:40*
