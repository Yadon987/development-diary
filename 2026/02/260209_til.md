# TIL - 2026年02月09日

## 今日のメモ
勉強時間：12時間

SDD＋TDDってイメージと真逆で忙しすぎじゃない？　コード書かせてる間にissue作ってると、コード見てる暇がない…

# 👨‍💻 開発日誌 (2026-02-10)

## 📝 本日の概要
本日は **「あるあるアリーナ (aruaruarena)」** プロジェクトにおいて、フロントエンド基盤の堅牢化とバックエンド審査システムの並行実装を集中的に行いました。
具体的には、**TanStack Query** や **Playwright** を導入して「型安全性」と「品質保証」のレベルを引き上げつつ、バックエンドでは **AWS Lambda** を想定した非同期処理の実装を進めました。
また、開発環境におけるゾンビプロセス起因のスタイル未反映問題など、環境固有のトラブルシューティングも解決し、開発効率を改善しました。

## 📸 スナップショット
![](https://res.cloudinary.com/dd4pdy5p7/image/upload/v1770753953/a48m1b1wsjb69shrbbq8.png)

---

## 🚀 プロジェクト: aruaruarena (Dev/Main)

### 🔧 主な実装・作業内容

#### 1. フロントエンド基盤構築 (Architecture & Type Safety)
- **APIクライアント基盤の実装 (E04-06)**:
  - `axios` をラップし、共通のエラーハンドリングと型定義を実装。
  - Zodスキーマを用いたランタイムバリデーション層を構築し、APIレスポンスの信頼性を担保。
- **状態管理と非同期処理 (E04-07)**:
  - **TanStack Query v5** を導入し、サーバー状態のキャッシュ戦略を設計。
  - **Framer Motion** を用いたUIインタラクションの基盤整備。
- **モックサーバーの導入 (E04-09)**:
  - **MSW (Mock Service Worker)** をセットアップし、バックエンド未完成の状態でもフロントエンド開発が先行できるよう環境を整備。

#### 2. 品質保証とテスト戦略 (QA & Testing)
- **E2Eテストの導入 (E04-08)**:
  - **Playwright** を採用し、実際のブラウザ環境での動作検証を自動化。
  - CI環境での実行を想定した設定ファイルの最適化。
- **TDD (テスト駆動開発) の実践 (E05-01)**:
  - 投稿機能のサーバーサイドバリデーションにおいて、RED → GREEN → REFACTOR のサイクルを回して実装。
  - エッジケース（境界値、不正な文字コードなど）のカバレッジを確保。

#### 3. バックエンド非同期処理 (Backend & Infrastructure)
- **審査トリガーの実装 (E05-06)**:
  - 投稿後のAI審査プロセスを非同期で実行するため、Rubyの `Thread` を使用した並列処理を実装（AWS Lambda環境への移行を見据えた設計）。
  - レースコンディション対策を行い、データの整合性を強化。

### 🛠️ 技術的な挑戦と解決 (Key Challenges & Solutions)

#### 🛑 Tailwind CSS スタイル未反映問題の解決
- **課題**: 開発サーバー (`vite`) 上で、Tailwindのスタイル変更が即座に反映されない事象が発生。キャッシュ削除や設定見直しを行っても解消せず。
- **原因特定**: `lsof -i :5173` コマンドによる調査の結果、以前のプロセスが「ゾンビプロセス」としてポートを占有し続けていたことが判明。
- **解決策**: 該当プロセスを強制終了 (`kill -9`) し、開発サーバーを再起動することで完全解消。再発防止のため、開発終了時のプロセス管理手順を見直し。

#### 🔄 テスト戦略の最適化 (Unit vs E2E vs Mock)
- **課題**: フロントエンドのテストにおいて、バックエンド依存度が高く、テストが不安定になりがちだった。
- **解決策**:
  - **Unit/Integration**: MSWを用いてネットワーク層をモック化し、高速かつ安定したテストを実現。
  - **E2E**: Playwrightを用い、実際のユーザーフロー（投稿→表示）のみを重点的に検証するよう責務を分離。

---

## 📊 本日のコミットログ (Git Log)

以下は本日の主要なコミット履歴です（mergeコミットを除く）。

# Backend & Core Features
[bcbc7a3f] fix: Post削除時のテストでレースコンディションを修正
[b2c7480d] refactor: E05-06 審査トリガーのリファクタリング
[b7148a1c] feat: E05-06 審査トリガーの実装（Lambda内でThread並列実行）
[c09a60b3] refactor: E05-01 投稿バリデーションのリファクタリング (#29)
[dc83717a] feat: E05-01 #27 投稿バリデーションの実装（GREEN）
[14397c35] test: E05-01 #27 投稿バリデーションのREDテスト作成

# Frontend Foundation & Testing
[42c9bdd2] fix: E04-02 Resolve Tailwind display issues and add verification UI
[88fd6be4] feat: E04-09 MSW導入 & docs: E05-01 投稿バリデーション仕様策定 (#28)
[71d85704] 🎭 E04-08: Playwrightの導入とE2Eテスト基盤の構築 (#25)
[3207eaaa] 🎯 E04-07: TanStack Query / Framer Motion の導入 (#24)
[2e936d50] feat: E04-06 APIクライアント基盤の実装とRefactor (#22)
[6b107623] feat: E04-05 共通型定義の作成とRefactor (#20)

# Code Quality & Refactoring
[927b88ce] fix: E05-01 CodeRabbit指摘対応（全角空白処理・ログ出力仕様）
[9de2cd4d] fix: SimpleCovのファイル単位カバレッジ警告を解消
[b4e84d10] refactor: CLAUDE.mdのコミットフォーマット説明を可読化

---

## 💡 今日の振り返り (Reflections)

本日は「開発環境の整備」と「機能実装」のバランスを意識して進めました。特に MSW と Playwright の導入により、フロントエンド開発がバックエンドの進捗に左右されにくい体制（APIファースト）が整いました。
また、ゾンビプロセスの件を通じて、トラブルシューティングにおける「仮説検証ループ（静的解析→動的解析→プロセス確認）」の重要性を再認識しました。

明日は、本日構築した基盤を用い、**E05: 投稿API** とフロントエンドの統合を進め、E2Eテストでの疎通確認を目指します。

## 気分・状態
今日の気分: 😁 (5: とても気分が良い)
今日のモチベーション: 🌈 (5: とてもやる気がある)
目標の進捗: 🌳 (5: とてもよく進んだ)

---
*Generated by ちいくさ日記*  
*Date: 2026-02-09*  
*Created: 2026-02-11 05:20:35*
