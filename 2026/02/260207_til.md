# TIL - 2026年02月07日

## 今日のメモ
勉強時間：12時間

GLM4.7のAPIを有効化しようとしたが、AIのハルシネーションを見破るのに少し時間を無駄にしてしまった。

# 👨‍💻 開発日誌 (2026/02/07) - プロジェクト: あるあるアリーナ

## 📝 今日のハイライト
1. **DynamoDB設計の刷新**: GSI活用によるクエリ最適化とコスト削減（RDB脳からの脱却）
2. **AIモデルの再選定**: Gemini 2.5 Flash / GLM-4-Flash による「爆速・低コスト」化
3. **UX/サウンド設計**: ユーザー体験を最大化するBGM・効果音・OGP戦略の策定

## 📸 スクリーンショット / 設計図
![](https://res.cloudinary.com/dd4pdy5p7/image/upload/v1770472883/y5dac7j4umlws00xmbvt.png)
![](https://res.cloudinary.com/dd4pdy5p7/image/upload/v1770472802/s3381gj1dxgmmlnhlkzs.png)

---

## 💡 技術的な意思決定 (Technical Decisions)

### 1. NoSQL (DynamoDB) への挑戦と設計最適化
- **課題**: `scan` 操作によるパフォーマンス低下とコスト増。
- **解決策**:
    - グローバルセカンダリインデックス (GSI) を活用し、ランキング取得を `Query` で完結させる設計に変更。
    - 複合キー (`pk: RANKING#ALL`, `sk: score`) を導入し、ソート済みデータを高速に取得可能に。
- **学び**: RDBの正規化とは異なる、NoSQL特有の「アクセスパターンありき」の設計思想を実践。

### 2. 生成AIモデルの最適化（コスト vs 速度）
- **課題**: 3人のAI審査員を並列で動かす際のレイテンシと運用コスト。
- **解決策**:
    - **ひろゆき風**: `Gemini 2.5 Flash` (Google) - 高速かつ論理的。
    - **デヴィ夫人風**: `GLM-4.7-FlashX` (Zhipu AI) - 安価でキャラクター性が高い。
    - **中尾彬風**: `GPT-4o-mini` (OpenAI) - 安定した演技力とコスパの良さ。
- **結果**: 1リクエストあたりのコストを大幅に削減しつつ、並列実行時の合計レスポンスタイムを短縮。

### 3. モダンな技術スタックの選定 (Rails 8 API Mode)
- **Backend**: Rails 8.0 (API Mode) + Dynamoid (ORM)
    - 不要なActiveRecord依存を排除 (`--skip-active-record`)。
    - テストには `RSpec` + `FactoryBot` を採用し、品質を担保。
- **Frontend**: React + Vite + TypeScript
    - `Framer Motion` によるリッチなUI体験。

---

## 🎨 UI/UX Design Updates

### サウンドデザイン (Sound Design)
- **コンセプト**: 「レトロフューチャー＆プレイフル」
- **BGM選定**:
    - 入力中: `ラデツキー行進曲` (ワクワク感)
    - 審査中: `クシコス・ポスト` or `道化師のギャロップ` (疾走感)
    - 結果発表: `威風堂々` (成功) / `運命` (失敗)
- **工夫点**: ユーザーの操作感を高めるため、SE（決定音、ドラムロール）を細かく定義。

### OGP戦略 (Social Sharing)
- **シェア体験**: ユーザーが結果をSNSで共有したくなる仕掛け。
- **技術**: `mini_magick` を用いた動的画像生成 + AWS CloudFront でのキャッシュ戦略（ウォームアップ方式）を採用し、Twitter(X)での表示速度を確保。

---

## 📂 ドキュメント整備 (Documentation)
保守性とオンボーディングのしやすさを意識し、ドキュメント構成を整理。

- `README.md`: プロジェクトの全体像、技術スタック、インフラ構成図を最新化。
- `docs/db_schema.md`: DynamoDBのテーブル設計、属性定義。
- `docs/screen_design.md`: 画面遷移フロー、UI仕様。
- `docs/Gemfile.md`: 使用Gemの選定理由と用途一覧。

---

## 🔧 Git Log (Today's Commits)
- docs: Gemfile設計書 (使用予定Gem一覧) を追加
- docs: ディレクトリパスを doc/ から docs/ に修正
- docs: 画面設計書のリネームとAIモデルの更新 (Gemini 2.5 Flash / GLM-Flash)
- docs: サウンド設計（BGM・SE・技術要件）をREADMEに追記
- docs: 実装計画とREADMEの更新
- docs: DB設計の刷新 (DynamoDB GSI設計)

---

## 🚀 Next Step
- **Backend Setup**: Railsプロジェクトの初期化 (`rails new`)
- **Core Implementation**: DynamoDB Localのセットアップとモデル実装

## 気分・状態
今日の気分: 😁 (5: とても気分が良い)
今日のモチベーション: 🌈 (5: とてもやる気がある)
目標の進捗: 🌳 (5: とてもよく進んだ)

---
*Generated by ちいくさ日記*  
*Date: 2026-02-07*  
*Created: 2026-02-07 23:04:31*
